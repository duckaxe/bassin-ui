(()=>{"use strict";var e={86:function(e,s,t){var r=t(893),l=t(294),n=t(745);let a=t.p+"static/svg/logo.688e3884.svg";var i=t(935);function o(e){let{children:s,text:t}=e,[n,a]=(0,l.useState)(!1),[o,c]=(0,l.useState)({top:0,left:0}),h=(0,l.useRef)(null),d=l.Children.only(s),{ref:x,onMouseEnter:j,onMouseLeave:u}=d.props,m=x?function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return e=>{s.forEach(s=>{s&&("function"==typeof s?s(e):"object"==typeof s&&(s.current=e))})}}(h,x):h,p=l.cloneElement(d,{ref:m,onMouseEnter:e=>{if(j&&j(e),h.current){let e=h.current.getBoundingClientRect();c({top:e.top+window.scrollY-32,left:e.left+window.scrollX+e.width/2}),a(!0)}},onMouseLeave:e=>{u&&u(e),a(!1)}});return(0,r.jsxs)(r.Fragment,{children:[p,n&&i.createPortal((0,r.jsx)("span",{className:"tooltip",style:{top:o.top,left:o.left},children:t}),document.body)]})}function c(e){let{timer:s}=e,t=Math.max(0,100-s/60*100),l={width:`${t.toFixed(2)}%`};return(0,r.jsxs)("footer",{className:"footer",children:[(0,r.jsx)("div",{className:"progress",style:l}),(0,r.jsxs)("div",{className:"wrapper",children:[(0,r.jsxs)("figure",{children:[(0,r.jsx)("img",{src:a,width:48,height:48,alt:"BASSIN Logo"}),(0,r.jsx)("figcaption",{className:"font-monospace",children:"BASSIN"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Stratum Host"}),(0,r.jsx)("code",{children:`${window.location.hostname}:3456`})]}),(0,r.jsx)(o,{text:"GitHub",children:(0,r.jsx)("a",{href:"https://github.com/duckaxe/bassin",children:(0,r.jsx)("svg",{viewBox:"0 0 98 98",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"})})})})]})]})]})}function h(e){let{label:s,headline:t}=e;return(0,r.jsxs)("section",{className:"metric",children:[(0,r.jsx)("span",{className:"metric-label",children:s}),(0,r.jsx)("h3",{className:"metric-headline font-barlow",dangerouslySetInnerHTML:{__html:t}})]})}let d=e=>{let s=e.match(/^([\d.]+)([KMGTPEZY])$/);if(!s)return e;let[,t,r]=s;return`${t}<span>${r}h/s</span>`},x=function(e){let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];for(let{limit:t,symbol:r}of[{limit:1e12,symbol:"T"},{limit:1e9,symbol:"G"},{limit:1e6,symbol:"M"},{limit:1e3,symbol:"K"}])if(e>=t)return parseFloat((e/t).toFixed(2)).toString()+(s?`<span>${r}</span>`:` ${r}`);return parseFloat(e.toFixed(2)).toString()},j=e=>{let s=Math.floor(e/86400),t=Math.floor(e%86400/3600),r=Math.floor(e%3600/60);return s?`${s}<span>d</span> ${t}<span>h</span>`:t?`${t}<span>h</span> ${r}<span>m</span>`:`${r}<span>m</span>`},u=e=>{let s=Math.floor(Date.now()/1e3)-e;return s>60?`${j(s)} <span>ago</span>`:"now"};function m(e){return{__html:e}}function p(e){let{pool:s}=e;return(0,r.jsxs)("div",{className:"tiles",children:[(0,r.jsxs)("section",{className:"tile",children:[(0,r.jsx)("h3",{className:"tile-headline font-barlow",children:"Hashrate"}),(0,r.jsxs)("ul",{className:"tile-items",children:[(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"5 Minutes",headline:d(s.hashrate5m)})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"1 Hour",headline:d(s.hashrate1hr)})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"1 Day",headline:d(s.hashrate1d)})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"1 Week",headline:d(s.hashrate7d)})})]})]}),(0,r.jsxs)("section",{className:"tile",children:[(0,r.jsx)("h3",{className:"tile-headline font-barlow",children:"Shares"}),(0,r.jsxs)("ul",{className:"tile-items",children:[(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"Best",headline:x(s.bestshare)})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"/Second",headline:`${s.SPS1m}`})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"Accepted",headline:x(s.accepted)})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"Rejected",headline:x(s.rejected)})})]})]}),(0,r.jsxs)("section",{className:"tile",children:[(0,r.jsx)("h3",{className:"tile-headline font-barlow",children:"Info"}),(0,r.jsxs)("ul",{className:"tile-items",children:[(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"Uptime",headline:j(s.runtime)})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:`User${1!==s.Users?"s":""}`,headline:`${s.Users}`})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:"Update",headline:u(s.lastupdate)})}),(0,r.jsx)("li",{className:"tile-item",children:(0,r.jsx)(h,{label:`Worker${1!==s.Workers?"s":""}`,headline:`${s.Workers}`})})]})]})]})}function f(e){let{username:s,onToggle:t,isExpanded:n}=e,a=`userVisible_${s.slice(0,21)}`,[i,c]=(0,l.useState)(()=>{let e=localStorage.getItem(a);return null===e||JSON.parse(e)});return(0,l.useEffect)(()=>{localStorage.setItem(a,JSON.stringify(i))},[a,i]),(0,r.jsxs)("div",{className:"divider",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"User"}),(0,r.jsx)(o,{text:s,children:(0,r.jsx)("strong",{className:i?"":"hidden",children:s})})]}),(0,r.jsxs)("div",{className:"controls",children:[(0,r.jsx)(o,{text:"User visibility",children:(0,r.jsx)("button",{onClick:()=>{c(e=>!e)},children:(0,r.jsx)("i",{className:`eye ${i?"":"hidden"}`})})}),(0,r.jsx)(o,{text:"Table visibility",children:(0,r.jsx)("button",{onClick:t,children:(0,r.jsx)("i",{className:`arrow ${n?"down":"up"}`})})})]})]})}function g(e){let{step:s}=e;return(0,r.jsxs)("div",{className:"stepper","data-step":s,children:[(0,r.jsxs)("ul",{className:"steps",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{children:"Node"}),(0,r.jsx)("hr",{})]}),(0,r.jsx)("li",{children:(0,r.jsx)("span",{children:"Shares"})})]}),(0,r.jsxs)("ul",{className:"panel",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("h3",{className:"font-barlow",children:"Connecting Node ..."}),(0,r.jsx)("p",{children:"Ensure that your Bitcoin Node is running and fully synced."})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("h3",{className:"font-barlow",children:"Awaiting Shares ..."}),(0,r.jsx)("table",{children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Host"}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:`${window.location.hostname}:3456`})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Username"}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"<btcaddress>.<worker>"})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Password"}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"x"})})]})]})})]})]})]})}function w(e){let{user:s}=e;return(0,r.jsxs)("table",{children:[(0,r.jsxs)("thead",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col"}),(0,r.jsx)("th",{scope:"col",colSpan:4,className:"font-barlow",children:"Hashrate"}),(0,r.jsx)("th",{scope:"col"}),(0,r.jsx)("th",{scope:"col",colSpan:4,className:"font-barlow",children:"Shares"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",children:"Worker"}),(0,r.jsx)("th",{scope:"col",children:"5 Minutes"}),(0,r.jsx)("th",{scope:"col",children:"1 Hour"}),(0,r.jsx)("th",{scope:"col",children:"1 Day"}),(0,r.jsx)("th",{scope:"col",children:"1 Week"}),(0,r.jsx)("th",{scope:"col"}),(0,r.jsx)("th",{scope:"col",children:"â†“ Best"}),(0,r.jsx)("th",{scope:"col",children:"Best Ever"}),(0,r.jsx)("th",{scope:"col",children:"Total"}),(0,r.jsx)("th",{scope:"col",children:"Last"})]})]}),(0,r.jsxs)("tbody",{children:[s.worker.sort((e,s)=>s.bestshare-e.bestshare).map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{scope:"row",children:e.workername.split(".").pop()}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(d(e.hashrate5m))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(d(e.hashrate1hr))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(d(e.hashrate1d))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(d(e.hashrate7d))}),(0,r.jsx)("td",{}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(x(e.bestshare))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(x(e.bestever))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(x(e.shares))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(u(e.lastshare))})]},e.workername)),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{scope:"row"}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(d(s.hashrate5m))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(d(s.hashrate1hr))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(d(s.hashrate1d))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(d(s.hashrate7d))}),(0,r.jsx)("td",{}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(x(s.bestshare))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(x(s.bestever))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(x(s.shares))}),(0,r.jsx)("td",{dangerouslySetInnerHTML:m(u(s.lastshare))})]})]})]})}function b(e){let{chart:s}=e,t=Math.max(...s);return(0,r.jsxs)("div",{className:"chart",children:[(0,r.jsx)("ul",{children:s.map((e,l)=>{let n=l>0?s[l-1]:null;return(0,r.jsx)(o,{text:x(e,!1)+"h/s",children:(0,r.jsx)("li",{style:{"--start":n?n/t:0,"--end":e?e/t:0}})},l)})}),1===s.length&&(0,r.jsx)("small",{children:"Preparing 5 Minutes Hashrate Chart ..."})]})}let N="userTablesVisible",y=l.memo(e=>{let{pool:s,users:t,chart:n}=e,a=t.length>0,i=n.length>0,[o,c]=(0,l.useState)({});return(0,l.useLayoutEffect)(()=>{let e=window.localStorage.getItem(N),s={};if(e){let r=JSON.parse(e);t.forEach(e=>{let t=e.username.slice(0,21);s[t]=void 0===r[t]||r[t]})}else t.forEach(e=>{s[e.username.slice(0,21)]=!0});c(s)},[t]),(0,l.useEffect)(()=>{window.localStorage.setItem(N,JSON.stringify(o))},[o]),(0,r.jsx)(r.Fragment,{children:a?(0,r.jsxs)("div",{className:"dashboard",children:[(0,r.jsx)(p,{pool:s}),i&&(0,r.jsx)(b,{chart:n}),t.map(e=>{let s=e.username.slice(0,21);return(0,r.jsxs)("section",{className:"user",children:[(0,r.jsx)(f,{username:e.username,onToggle:()=>(e=>{let s=e.slice(0,21);c(e=>({...e,[s]:!e[s]}))})(e.username),isExpanded:o[s]}),o[s]&&(0,r.jsx)(w,{user:e})]},s)})]}):(0,r.jsx)(g,{step:2})})});function S(){return(0,r.jsx)("div",{className:"loader",children:(0,r.jsx)("span",{})})}let v=async e=>{try{let s=await fetch(e);if(!s.ok)throw Error(`Request failed: ${s.status} ${s.statusText}`);return s}catch(e){throw e}},M=async()=>{try{let e=await v(`/pool/pool.status?${Date.now()}`),s=(await e.text()).trim().split("\n").filter(Boolean);if(s.length<3)throw Error("Malformed pool response");let[t,r,l]=s.map(e=>JSON.parse(e));return{...t,...r,...l}}catch(e){throw console.error("Error in fetchPool:",e),e instanceof Error?e:Error("Unknown error in fetchPool")}},$=async()=>{try{let e=`/users/?${Date.now()}`,s=await v(e),t=[...(await s.text()).matchAll(/href="([^"]+)"/g)].map(e=>{let[,s]=e;return s}).filter(Boolean);if(0===t.length)return[];return await Promise.all(t.map(async e=>{let s=await v(`/users/${e}?${Date.now()}`);return{...await s.json(),username:e}}))}catch(e){throw console.error("Error in fetchUsers:",e),e instanceof Error?e:Error("Unknown error in fetchUsers")}},H=document.getElementById("root");H&&n.createRoot(H).render((0,r.jsx)(l.StrictMode,{children:(0,r.jsx)(()=>{let[e,s]=(0,l.useState)(null),[t,n]=(0,l.useState)([]),[a,i]=(0,l.useState)([]),[o,h]=(0,l.useState)(0),[d,x]=(0,l.useState)(!1),j=(0,l.useCallback)(async()=>{try{let[e,t]=await Promise.all([M(),$()]);x(!1),e&&(s(e),i(s=>[...s,(e=>{if(!e)return 0;let s=e.trim().match(/^([\d.,]+)\s*([KMGTPEZY]?)[H]?\b/i);if(!s)return NaN;let t=parseFloat(s[1].replace(",",".")),r=s[2].toUpperCase();return t*(({H:1,K:1e3,M:1e6,G:1e9,T:1e12,P:1e15,E:1e18,Z:1e21,Y:1e24})[r]||1)})(e.hashrate5m)].slice(-61))),t&&n(t)}catch(e){console.error("Data fetch error:",e),x(!0)}},[]);return(0,l.useEffect)(()=>{j();let e=setInterval(()=>{h(e=>{let s=e+1;return s>=60?(j(),0):s})},1e3);return()=>clearInterval(e)},[j]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c,{timer:o}),d?(0,r.jsx)(g,{step:1}):e?(0,r.jsx)(y,{pool:e,users:t,chart:a}):(0,r.jsx)(S,{})]})},{})}))}},s={};function t(r){var l=s[r];if(void 0!==l)return l.exports;var n=s[r]={exports:{}};return e[r](n,n.exports,t),n.exports}t.m=e,t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e=[];t.O=(s,r,l,n)=>{if(r){n=n||0;for(var a=e.length;a>0&&e[a-1][2]>n;a--)e[a]=e[a-1];e[a]=[r,l,n];return}for(var i=1/0,a=0;a<e.length;a++){for(var[r,l,n]=e[a],o=!0,c=0;c<r.length;c++)(!1&n||i>=n)&&Object.keys(t.O).every(e=>t.O[e](r[c]))?r.splice(c--,1):(o=!1,n<i&&(i=n));if(o){e.splice(a--,1);var h=l();void 0!==h&&(s=h)}}return s}})(),t.p="/",(()=>{var e={980:0};t.O.j=s=>0===e[s];var s=(s,r)=>{var l,n,[a,i,o]=r,c=0;if(a.some(s=>0!==e[s])){for(l in i)t.o(i,l)&&(t.m[l]=i[l]);if(o)var h=o(t)}for(s&&s(r);c<a.length;c++)n=a[c],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(h)},r=self.webpackChunkbassin=self.webpackChunkbassin||[];r.forEach(s.bind(null,0)),r.push=s.bind(null,r.push.bind(r))})();var r=t.O(void 0,["361"],function(){return t(86)});r=t.O(r)})();